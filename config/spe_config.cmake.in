#-------------------------------------------------------------------------------
# Copyright (c) 2023, Arm Limited. All rights reserved.
#
# SPDX-License-Identifier: BSD-3-Clause
#
#-------------------------------------------------------------------------------

# This CMake script template contains the set of options settled on secure side
# build but necessary for building the non-secure side too.

set(TFM_PARTITION_INTERNAL_TRUSTED_STORAGE @TFM_PARTITION_INTERNAL_TRUSTED_STORAGE@ CACHE BOOL      "Enable Internal Trusted Storage partition")
set(TFM_PARTITION_CRYPTO                   @TFM_PARTITION_CRYPTO@                CACHE BOOL      "Enable Crypto partition")
set(TFM_PARTITION_INITIAL_ATTESTATION      @TFM_PARTITION_INITIAL_ATTESTATION@   CACHE BOOL      "Enable Initial Attestation partition")
set(TFM_PARTITION_PROTECTED_STORAGE        @TFM_PARTITION_PROTECTED_STORAGE@     CACHE BOOL      "Enable Protected Storage partition")
set(TFM_PARTITION_PLATFORM                 @TFM_PARTITION_PLATFORM@              CACHE BOOL      "Enable Platform partition")
set(TFM_PARTITION_FIRMWARE_UPDATE          @TFM_PARTITION_FIRMWARE_UPDATE@       CACHE BOOL      "Enable firmware update partition")

# The options necessary for signing the final image
set(BL2                                    @BL2@)
set(BL2_HEADER_SIZE                        @BL2_HEADER_SIZE@)
set(BL2_TRAILER_SIZE                       @BL2_TRAILER_SIZE@)
set(MCUBOOT_IMAGE_NUMBER                   @MCUBOOT_IMAGE_NUMBER@)
set(MCUBOOT_CONFIRM_IMAGE                  @MCUBOOT_CONFIRM_IMAGE@)
set(MCUBOOT_ENC_IMAGES                     @MCUBOOT_ENC_IMAGES@)
set(MCUBOOT_ENC_KEY_LEN                    @MCUBOOT_ENC_KEY_LEN@)
set(MCUBOOT_MEASURED_BOOT                  @MCUBOOT_MEASURED_BOOT@)
set(MCUBOOT_ALIGN_VAL                      @MCUBOOT_ALIGN_VAL@)
set(MCUBOOT_UPGRADE_STRATEGY               @MCUBOOT_UPGRADE_STRATEGY@)
set(MCUBOOT_S_IMAGE_MIN_VER                @MCUBOOT_S_IMAGE_MIN_VER@)

set(MCUBOOT_MEASURED_BOOT                  @MCUBOOT_MEASURED_BOOT@)
set(MCUBOOT_HW_KEY                         @MCUBOOT_HW_KEY@)

set(MCUBOOT_SECURITY_COUNTER_S             @MCUBOOT_SECURITY_COUNTER_S@)
set(MCUBOOT_IMAGE_VERSION_S                @MCUBOOT_IMAGE_VERSION_S@)
set(MCUBOOT_KEY_S                          ${CONFIG_SPE_PATH}/image_signing/keys/root-RSA-3072.pem)

set(MCUBOOT_SECURITY_COUNTER_NS            @MCUBOOT_SECURITY_COUNTER_NS@)
set(MCUBOOT_IMAGE_VERSION_NS               @MCUBOOT_IMAGE_VERSION_NS@)
set(MCUBOOT_KEY_NS                         ${CONFIG_SPE_PATH}/image_signing/keys/root-RSA-3072_1.pem)

# The common options describing a platfomr configuration

set(TFM_PLATFORM                           @TFM_PLATFORM@          CACHE STRING    "Platform to build TF-M for. Must be either a relative path from [TF-M]/platform/ext/target, or an absolute path.")
set(CONFIG_TFM_USE_TRUSTZONE               @CONFIG_TFM_USE_TRUSTZONE@   CACHE BOOL "Use TrustZone")
set(CONFIG_TFM_SPM_BACKEND                 @CONFIG_TFM_SPM_BACKEND@     CACHE STRING "The SPM backend")
set(TFM_MULTI_CORE_TOPOLOGY                @TFM_MULTI_CORE_TOPOLOGY@    CACHE BOOL "Platform has multi core")
set(TFM_PARTITION_NS_AGENT_MAILBOX         @TFM_PARTITION_NS_AGENT_MAILBOX@ CACHE BOOL "Enable the Mailbox agents")
set(PLATFORM_DEFAULT_CRYPTO_KEYS           @PLATFORM_DEFAULT_CRYPTO_KEYS@   CACHE BOOL "Use the default crypto keys")
set(PSA_FRAMEWORK_HAS_MM_IOVEC             @PSA_FRAMEWORK_HAS_MM_IOVEC@     CACHE BOOL  "Enable the MM-IOVEC feature")
set(TFM_ISOLATION_LEVEL                    @TFM_ISOLATION_LEVEL@        CACHE   STRING  "The TFM isolation level")

#set(TFM_MULTI_CORE_NS_OS                  @TFM_MULTI_CORE_NS_OS@)
#set(TFM_MULTI_CORE_NS_OS_MAILBOX_THREAD   @TFM_MULTI_CORE_NS_OS_MAILBOX_THREAD@)

# Testing related options.

set(TEST_PSA_API                           "@TEST_PSA_API@"          CACHE STRING    "Which (if any) of the PSA API tests should be compiled")
set(PSA_ARCH_TESTS_PATH                    "@PSA_ARCH_TESTS_PATH@"   CACHE PATH      "Path to PSA arch test repository if it was give to SPE build")

# Other common options

set(TFM_VERSION                            @TFM_VERSION@)
set(TFM_NS_MANAGE_NSID                     @TFM_NS_MANAGE_NSID@)
